/*! angular-breadcrumb - v0.5.3
* http://ncuillery.github.io/angular-breadcrumb
* Copyright (c) 2016 Nicolas Cuillery; Licensed MIT */
!function(e,t,r){"use strict";function a(e,r){return t.equals(e.length,r.length)?e>r:e.length>r.length}function n(e){var t=e.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/);if(!t||4!==t.length)throw new Error("Invalid state ref '"+e+"'");return{state:t[1],paramExpr:t[3]||null}}function c(e,t,a,n){var c=l[e];c!==r&&c(),c=t.$on(a,n),l[e]=c}function u(){var e={prefixStateName:null,template:"bootstrap3",templateUrl:null,templateLast:"default",templateLastUrl:null,includeAbstract:!1,useRootParams:!1};this.setOptions=function(r){t.extend(e,r)},this.$get=["$state","$stateParams","$rootScope",function(t,u,i){var o=i;c("$Breadcrumb.$viewContentLoaded",i,"$viewContentLoaded",function(e){!e.targetScope.ncyBreadcrumbIgnore&&a(e.targetScope.$id,o.$id)&&(o=e.targetScope)});var s=function(e){var t=e.parent||(/^(.+)\.[^.]+$/.exec(e.name)||[])[1],r="object"==typeof t;return r?t.name:t},l=function(r,a){for(var c,i,s=n(a),l=!1,m=!1,p=0,d=r.length;d>p;p+=1)if(r[p].name===s.state)return;c=t.get(s.state),c.ncyBreadcrumb&&(c.ncyBreadcrumb.force&&(l=!0),c.ncyBreadcrumb.skip&&(m=!0)),c["abstract"]&&!e.includeAbstract&&!l||m||(s.paramExpr&&(i=o.$eval(s.paramExpr)),c.ncyBreadcrumbLink=t.href(s.state,i||u||{}),c.ncyBreadcrumbStateRef=a,r.unshift(c))},m=function(e){var r=n(e),a=t.get(r.state);if(a.ncyBreadcrumb&&a.ncyBreadcrumb.parent){var c="function"==typeof a.ncyBreadcrumb.parent,u=c?a.ncyBreadcrumb.parent(o):a.ncyBreadcrumb.parent;if(u)return u}return s(a)};return{getTemplate:function(t){return e.templateUrl?null:t[e.template]?t[e.template]:e.template},getTemplateUrl:function(){return e.templateUrl},getTemplateLast:function(t){return e.templateLastUrl?null:t[e.templateLast]?t[e.templateLast]:e.templateLast},getTemplateLastUrl:function(){return e.templateLastUrl},getStatesChain:function(r,a){for(var c=[],u=!1,i=t.$current.self.name;i;i=m(i)){if(a&&a.id&&e.useRootParams){var o=n(i),s=t.get(o.state),p=t.get("myReportsNew."+a.id);s&&s.ncyBreadcrumb&&s.ncyBreadcrumb.parent?(s.ncyBreadcrumb.parent==p.ncyBreadcrumb.parent&&(u=!0),u&&l(c,i)):l(c,i)}else l(c,i);if(r&&c.length)return c}return e.prefixStateName&&l(c,e.prefixStateName),c},getLastStep:function(){var e=this.getStatesChain(!0,$routeParams);return e.length?e[0]:r},$getLastViewScope:function(){return o}}}]}function i(e,r,a,n){var u={bootstrap2:'<ul class="breadcrumb"><li ng-repeat="step in steps" ng-switch="$last || !!step.abstract" ng-class="{active: $last}"><a ng-switch-when="false" href="{{step.ncyBreadcrumbLink}}">{{step.ncyBreadcrumbLabel}}</a><span ng-switch-when="true">{{step.ncyBreadcrumbLabel}}</span><span class="divider" ng-hide="$last">/</span></li></ul>',bootstrap3:'<ol class="breadcrumb"><li ng-repeat="step in steps" ng-class="{active: $last}" ng-switch="$last || !!step.abstract"><a ng-switch-when="false" href="{{step.ncyBreadcrumbLink}}">{{step.ncyBreadcrumbLabel}}</a><span ng-switch-when="true">{{step.ncyBreadcrumbLabel}}</span></li></ol>'};return{restrict:"AE",replace:!0,scope:{},template:r.getTemplate(u),templateUrl:r.getTemplateUrl(),link:{post:function(u){var i=[],o=function(){d(i),i=[];var a=r.$getLastViewScope();u.steps=r.getStatesChain(!1,n),t.forEach(u.steps,function(t){if(t.ncyBreadcrumb&&t.ncyBreadcrumb.label){var r=e(t.ncyBreadcrumb.label);t.ncyBreadcrumbLabel=r(a),p(i,r,a,t)}else t.ncyBreadcrumbLabel=t.name})};c("BreadcrumbDirective.$viewContentLoaded",a,"$viewContentLoaded",function(e){e.targetScope.ncyBreadcrumbIgnore||o()}),o()}}}}function o(e,t,r,a){var n={"default":"{{ncyBreadcrumbLabel}}"};return{restrict:"A",scope:{},template:t.getTemplateLast(n),templateUrl:t.getTemplateLastUrl(),compile:function(a,n){var u=a.attr(n.$attr.ncyBreadcrumbLast);return u&&a.html(u),{post:function(a){var n=[],u=function(){d(n),n=[];var r=t.$getLastViewScope(),c=t.getLastStep();if(c)if(a.ncyBreadcrumbLink=c.ncyBreadcrumbLink,c.ncyBreadcrumb&&c.ncyBreadcrumb.label){var u=e(c.ncyBreadcrumb.label);a.ncyBreadcrumbLabel=u(r),p(n,u,r,a)}else a.ncyBreadcrumbLabel=c.name};c("BreadcrumbLastDirective.$viewContentLoaded",r,"$viewContentLoaded",function(e){e.targetScope.ncyBreadcrumbIgnore||u()}),u()}}}}}function s(e,r,a,n){return{restrict:"A",scope:{},template:"{{ncyBreadcrumbChain}}",compile:function(u,i){var o=u.attr(i.$attr.ncyBreadcrumbText);o&&u.html(o);var s=u.attr(i.$attr.ncyBreadcrumbTextSeparator)||" / ";return{post:function(u){var i=[],o=function(e,r,a){t.forEach(m(r),function(t){var r=a.$watch(t,function(e,t){e!==t&&l()});e.push(r)})},l=function(){d(i),i=[];var a=r.$getLastViewScope(),c=r.getStatesChain(!1,n),l=[];t.forEach(c,function(t){if(t.ncyBreadcrumb&&t.ncyBreadcrumb.label){var r=e(t.ncyBreadcrumb.label);l.push(r(a)),o(i,r,a)}else l.push(t.name)}),u.ncyBreadcrumbChain=l.join(s)};c("BreadcrumbTextDirective.$viewContentLoaded",a,"$viewContentLoaded",function(e){e.targetScope.ncyBreadcrumbIgnore||l()}),l()}}}}}var l={},m=function(e){if(e.expressions)return e.expressions;var r=[];return t.forEach(e.parts,function(e){t.isFunction(e)&&r.push(e.exp)}),r},p=function(e,r,a,n){t.forEach(m(r),function(t){var c=a.$watch(t,function(){n.ncyBreadcrumbLabel=r(a)});e.push(c)})},d=function(e){t.forEach(e,function(e){e()})};i.$inject=["$interpolate","$breadcrumb","$rootScope","$routeParams"],o.$inject=["$interpolate","$breadcrumb","$rootScope","$routeParams"],s.$inject=["$interpolate","$breadcrumb","$rootScope","$routeParams"],t.module("ncy-angular-breadcrumb",["ui.router.state"]).provider("$breadcrumb",u).directive("ncyBreadcrumb",i).directive("ncyBreadcrumbLast",o).directive("ncyBreadcrumbText",s)}(window,window.angular);