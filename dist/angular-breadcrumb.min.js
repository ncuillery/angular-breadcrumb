/*! angular-breadcrumb - v0.2.2-dev-2014-06-23
* https://github.com/ncuillery/angular-breadcrumb
* Copyright (c) 2014 Nicolas Cuillery; Licensed MIT */
!function(a,b,c){function d(a,c){return b.equals(a.length,c.length)?a>c:a.length>c.length}function e(){var a={prefixStateName:null,template:"bootstrap3",templateUrl:null};this.setOptions=function(c){b.extend(a,c)},this.$get=["$state","$rootScope",function(e,f){var g=f;f.$on("$viewContentLoaded",function(a){d(a.targetScope.$id,g.$id)&&(g=a.targetScope)});var h=function(a,c){var d=i(a);return b.isDefined(d)&&b.isDefined(d.data)&&b.isDefined(d.data[c])&&b.equals(a.data[c],d.data[c])},i=function(a){if(b.isDefined(a.parent))return e.get(a.parent);var d=/^(.+)\.[^.]+$/.exec(a.name);return d?e.get(d[1]):c},j=function(a,c,d){var e=!1;b.forEach(a,function(a){!e&&b.equals(a,c)&&(e=!0)});var f=b.isDefined(c.data)&&c.data.ncyBreadcrumbSkip&&!h(c,"ncyBreadcrumbSkip");return e||c.abstract||f?!1:(d?a.splice(1,0,c):a.unshift(c),!0)},k=function(a){return b.isDefined(a.data)&&b.isDefined(a.data.ncyBreadcrumbParent)&&!h(a,"ncyBreadcrumbParent")?e.get(a.data.ncyBreadcrumbParent):i(a)};return{getTemplate:function(b){return a.templateUrl?null:b[a.template]?b[a.template]:a.template},getTemplateUrl:function(){return a.templateUrl},getStatesChain:function(){var c=[],d=!1;if(a.prefixStateName){var f=e.get(a.prefixStateName);if(!f)throw'Bad configuration : prefixState "'+a.prefixStateName+'" unknown';var g=b.extend(f,{ncyBreadcrumbLink:e.href(f)});d=j(c,g,d)}var h=e.$current.self;do{var i=b.extend(h,{ncyBreadcrumbLink:e.href(h.name)});j(c,i,d),h=k(h)}while(h&&""!==h.name);return c},$getLastViewScope:function(){return g}}}]}function f(a,c,d){return this.$$templates={bootstrap2:'<ul class="breadcrumb"><li ng-repeat="step in steps | limitTo:(steps.length-1)"><a href="{{step.ncyBreadcrumbLink}}">{{step.ncyBreadcrumbLabel}}</a> <span class="divider">/</span></li><li ng-repeat="step in steps | limitTo:-1" class="active"><span>{{step.ncyBreadcrumbLabel}}</span></li></ul>',bootstrap3:'<ol class="breadcrumb"><li ng-repeat="step in steps" ng-class="{active: $last}" ng-switch="$last"><a ng-switch-when="false" href="{{step.ncyBreadcrumbLink}}">{{step.ncyBreadcrumbLabel}}</a> <span ng-switch-when="true">{{step.ncyBreadcrumbLabel}}</span></li></ol>'},{restrict:"AE",replace:!0,scope:{},template:c.getTemplate(this.$$templates),templateUrl:c.getTemplateUrl(),link:{post:function(e){var f=[],g=function(a){if(a.expressions)return a.expressions;var c=[];return b.forEach(a.parts,function(a){b.isFunction(a)&&c.push(a.exp)}),c},h=function(a,c,d){b.forEach(g(a),function(b){var e=c.$watch(b,function(){d.ncyBreadcrumbLabel=a(c)});f.push(e)})},i=function(){b.forEach(f,function(a){a()}),f=[]},j=function(){i();var d=c.$getLastViewScope();e.steps=c.getStatesChain(),b.forEach(e.steps,function(b){if(b.data&&b.data.ncyBreadcrumbLabel){var c=a(b.data.ncyBreadcrumbLabel);b.ncyBreadcrumbLabel=c(d),h(c,d,b)}else b.ncyBreadcrumbLabel=b.name})};d.$on("$viewContentLoaded",function(){j()}),j()}}}}f.$inject=["$interpolate","$breadcrumb","$rootScope"],b.module("ncy-angular-breadcrumb",["ui.router.state"]).provider("$breadcrumb",e).directive("ncyBreadcrumb",f)}(window,window.angular);